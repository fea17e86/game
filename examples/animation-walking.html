<!Doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>animation walking</title>
    <style>
        body {
            font-family: monospace;
        }
        canvas {
            border: solid 1px #ccc;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h3>Klicke in das Canvas Element.</h3>
    <script src="../js/phaser/phaser.min.js"></script>
    <script>
        var game = new Phaser.Game(400, 120, Phaser.AUTO, 'animation-walking', {
            preload: preload,
            create: create,
            update: update
        });
        game.transparent = true;

        function preload() {
            game.load.atlasJSONHash('takashi_komuro', '../assets/sprites/chars/takashi_komuro.png', '../assets/sprites/chars/takashi_komuro.json');
        }

        var takashi_komuro;
        
        var current = 0, hStep = 1, vStep = 1;
        var animations = ['walk_down', 'walk_left', 'walk_up', 'walk_right'];
        var movements = [
            function (sprite) { sprite.y += vStep; },
            function (sprite) { sprite.x -= hStep; },
            function (sprite) { sprite.y -= vStep; },
            function (sprite) { sprite.x += hStep; }
        ];

        function create() {
            takashi_komuro = game.add.sprite(184, 36, 'takashi_komuro');
            takashi_komuro.animations.add('walk_down', [1, 0, 2, 0]);
            takashi_komuro.animations.add('walk_left', [4, 3, 5, 3]);
            takashi_komuro.animations.add('walk_right', [7, 6, 8, 6]);
            takashi_komuro.animations.add('walk_up', [10, 9, 11, 9]);
            takashi_komuro.animations.play(animations[current], 5, true);
            game.input.onDown.add(changeAnimation, this);
        }
        
        function changeAnimation () {
            takashi_komuro.animations.stop(animations[current], true);
            current++;
            if (current > animations.length - 1) {
                current = 0;
            }
            takashi_komuro.animations.play(animations[current], 5, true);
        }

        function update () {
            movements[current](takashi_komuro);
            if (takashi_komuro.x < -takashi_komuro.width) {
                takashi_komuro.x = game.world.width;
            } else if (takashi_komuro.x > game.world.width) {
                takashi_komuro.x = -takashi_komuro.width;
            }
            if (takashi_komuro.y < -takashi_komuro.height) {
                takashi_komuro.y = game.world.height;
            } else if (takashi_komuro.y > game.world.height) {
                takashi_komuro.y = -takashi_komuro.height;
            }
        }
    </script>
</body>

</html>